import{Type as x,setComponent as L}from"@dojoengine/recs";import{poseidonHashMany as k}from"micro-starknet";import{byteArray as J}from"starknet";var U="0x1a2f334228cee715f1f0f54053bb6b5eac54fa336e0bc1aacf7516decb0471d",W="-";function gt(t){return t.events.filter(n=>n.keys.length===1&&n.keys[0]===U)}function bt(t,n){n.forEach(o=>X(t,o.data))}function X(t,n){let o=Y(t);try{let r=D(Array.from(o.keys()),n),a=t[o.get(r)],m=parseInt(n[1]),s=2+m+1,c=n.slice(2,2+m).map(l=>BigInt(l)),u=q(c),d=parseInt(n[s]),f=c.map(l=>l.toString()),g=n.slice(s,s+d),y=Z(a,[...f,...g]);L(a,u,y)}catch(r){console.log(r)}}function Y(t){let n=new Map;for(let o of Object.keys(t)){let r=t[o];n.set(r.metadata?.name,o)}return n}function $(t,n){switch(n){case x.Boolean:return t!=="0x0";case x.Number:return Number(t);case x.BigInt:return BigInt(t);default:return t}}function Z(t,n){let o=t.schema,r=t.metadata?.types??[];return Q(o,r,n,{types:0,values:0})}function Q(t,n,o,r){return Object.keys(t).reduce((a,m)=>{let s=t[m];if(typeof s=="object")a[m]=Q(s,n,o,r);else{if(a[m]=$(o[r.values],s),r.values++,n[r.types]=="u256"){let c=$(o[r.values],s);a[m]|=c<<128n,r.values++}r.types++}return a},{})}function xt(t){for(var n="",o=2;o<t.length;o+=2)n+=String.fromCharCode(parseInt(t.substr(o,2),16));return n}function D(t,n){let o=t.reduce((m,s)=>{let c=et(s);return m[tt(c[0],c[1])]=s,m},{}),r=n[0],a=o[r];if(!a)throw new Error(`Action ${r} not found in actions : ${t}`);return a}function v(t){return"0x"+t.toString(16)}function tt(t,n){return v(k([G(t),G(n)]))}function nt(t){return[BigInt(t.data.length),...t.data.map(o=>BigInt(o.toString())),BigInt(t.pending_word),BigInt(t.pending_word_len)]}function G(t){let n=J.byteArrayFromString(t);return k(nt(n))}function et(t){return t.split(W)}function q(t){return"0x"+k(t).toString(16)}function Ct(t,n){n.forEach(o=>{ot(t,o)})}function ot(t,n){let o=n.node.keys.map(a=>BigInt(a)),r=q(o);n.node.models.forEach(a=>{let m=a.__typename,s=t[m];if(!s){console.error(`Component ${m} not found`);return}let c=Object.keys(s.schema).reduce((u,d)=>{let f=a[d],g=z(f,s.schema[d]);return u[d]=g,u},{});L(s,r,c)})}function z(t,n){if(t==null)return t;if(typeof n=="object"&&n!==null){let o={};for(let r in n)o[r]=z(t[r],n[r]);return o}switch(n){case x.Boolean:return!!t;case x.Number:return typeof t=="string"?0:isNaN(Number(t))?t:Number(t);case x.BigInt:return BigInt(t);default:return t}}function Et(t,n=6){if(t?.length<=n)return t;let o=Math.floor(n/2),r=t.slice(0,o),a=t.slice(-o);return`${r}...${a}`}import*as e from"mathjs";var i=(t,n)=>!Array.isArray(t)||!Array.isArray(n)?e.multiply(t,n):t.map((o,r)=>o*n[r]),C=t=>t.map(n=>Math.floor(n)),K=(t,n)=>t.map((o,r)=>n[r]<=o?0:1),rt=t=>t.map(n=>n-Math.floor(n*(1/289))*289),O=t=>(t=t.map(n=>(n*34+1)*n),rt(t)),at=t=>t.map(n=>1.79284291400159-.85373472095314*n),st=t=>{let n=[.16666666666666666,.3333333333333333],o=[0,.5,1,2],r=C(e.add(t,e.dot(t,[n[1],n[1],n[1]]))),a=e.add(e.subtract(t,r),e.dot(r,[n[0],n[0],n[0]])),m=K([a[1],a[2],a[0]],[a[0],a[1],a[2]]),s=e.subtract(1,m),c=e.min([[m[0],m[1],m[2]],[s[2],s[0],s[1]]],0),u=e.max([[m[0],m[1],m[2]],[s[2],s[0],s[1]]],0),d=e.add(e.subtract(a,c),[n[0],n[0],n[0]]),f=e.add(e.subtract(a,u),[n[1],n[1],n[1]]),g=e.subtract(a,[o[1],o[1],o[1]]),y=O(e.add(r[2],[0,c[2],u[2],1])),l=O(e.add(e.add(y,r[1]),[0,c[1],u[1],1])),w=O(e.add(e.add(l,r[0]),[0,c[0],u[0],1])),p=[.285714285714286,-.928571428571428,.142857142857143],M=e.subtract(w,i(49,C(i(w,p[2]*p[2])))),H=C(i(M,p[2])),P=C(e.subtract(M,i(7,H))),E=e.add(i(H,p[0]),[p[1],p[1],p[1],p[1]]),I=e.add(i(P,p[0]),[p[1],p[1],p[1],p[1]]),N=e.subtract(e.subtract(1,e.abs(E)),e.abs(I)),B=[E[0],E[1],I[0],I[1]],T=[E[2],E[3],I[2],I[3]],_=e.add(i(C(B),2),1),R=e.add(i(C(T),2),1),h=i(-1,K(N,[0,0,0,0])),V=e.add([B[0],B[2],B[1],B[3]],i([_[0],_[2],_[1],_[3]],[h[0],h[0],h[1],h[1]])),F=e.add([T[0],T[2],T[1],T[3]],i([R[0],R[2],R[1],R[3]],[h[2],h[2],h[3],h[3]])),A=[V[0],V[1],N[0]];y=[V[2],V[3],N[1]],l=[F[0],F[1],N[2]];let S=[F[2],F[3],N[3]],j=at([e.dot(A,A),e.dot(y,y),e.dot(l,l),e.dot(S,S)]);A=i(A,j[0]),y=i(y,j[1]),l=i(l,j[2]),S=i(S,j[3]);let b=e.max([e.subtract(.5,[e.dot(a,a),e.dot(d,d),e.dot(f,f),e.dot(g,g)]),[0,0,0,0]],0);return b=i(b,b),b=i(b,b),i(105,e.dot(b,[e.dot(A,a),e.dot(y,d),e.dot(l,f),e.dot(S,g)]))},Nt=(t,n,o)=>{let r=0,a=1,m=1,s=0;for(let u=0;u<o;u++)r+=st(i(t,a))*m,s+=m,m*=n,a*=2;return r/s};export{G as computeByteArrayHash,Z as decodeComponent,D as getComponentNameFromEvent,q as getEntityIdFromKeys,gt as getEvents,tt as getSelectorFromTag,xt as hexToAscii,$ as parseComponentValue,z as parseComponentValueFromGraphQLEntity,Nt as recursiveSNoise,X as setComponentFromEvent,ot as setComponentFromGraphQLEntity,bt as setComponentsFromEvents,Ct as setComponentsFromGraphQLEntities,Et as shortenHex,st as snoise,et as splitEventTag};
//# sourceMappingURL=index.js.map